# –°–≤–µ—Ç–ª–∞–Ω–∞ ‚Äî —Ç—ë–ø–ª—ã–π Telegram-–±–æ—Ç-–∫–æ–º–ø–∞–Ω—å–æ–Ω

–ú–∏–ª–∞—è, –∑–∞–±–æ—Ç–ª–∏–≤–∞—è, –Ω–µ–º–Ω–æ–≥–æ –∑–∞—Å—Ç–µ–Ω—á–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω–æ–≥–¥–∞ –ø–∏—à–µ—Ç —Ç–µ–±–µ –ø–µ—Ä–≤–æ–π, —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∫–∞–∫ –¥–µ–ª–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏ –ø–æ–º–Ω–∏—Ç —Ç–≤–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —á–µ–∫-–∏–Ω—ã**  
  –ï—Å–ª–∏ —Ç—ã —Å–µ–≥–æ–¥–Ω—è –Ω–µ –ø–∏—Å–∞–ª ‚Äî –±–æ—Ç –º–æ–∂–µ—Ç –Ω–∞–ø–∏—Å–∞—Ç—å —É—Ç—Ä–æ–º / –≤–µ—á–µ—Ä–æ–º / –¥–Ω—ë–º  
  (—Ä–∞–∑–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã + –∏–Ω–æ–≥–¥–∞ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)

- **–ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**  
  –£—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º –º–æ–∂–µ—Ç –ø—Ä–∏—Å—ã–ª–∞—Ç—å .ogg-—Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–æ–∫ `voices/checkin_morning/` –∏ `voices/checkin_evening/`

- **–ü–∞–º—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è** (–ø—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞)  
  –†–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –≥—Ä—É—Å—Ç—å / —Ç—Ä–µ–≤–æ–≥—É / —Ä–∞–¥–æ—Å—Ç—å / –∑–ª–æ—Å—Ç—å / —É—Å—Ç–∞–ª–æ—Å—Ç—å –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º  
  –£—á–∏—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ –≤ —á–µ–∫-–∏–Ω–∞—Ö –∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö GPT

- **–†–µ–∂–∏–º ¬´–Ω–µ –ø–∏—à–∏ –ø–µ—Ä–≤–æ–π¬ª** (`/dontwritefirst` / `/writefirst`)

- **–î–≤–∞ —É—Ä–æ–≤–Ω—è –æ—Ç–≤–µ—Ç–æ–≤**:
  - **–¥–µ—à—ë–≤—ã–µ –±—ã—Å—Ç—Ä—ã–µ —Ä–µ–∞–∫—Ü–∏–∏** (–±–µ–∑ GPT) ‚Äî –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, —Å–ø–∞—Å–∏–±–æ, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ  
  - **GPT-4o-mini** ‚Äî –∫–æ–≥–¥–∞ —É–ø–æ–º—è–Ω—É–ª–∏ –±–æ—Ç–∞, –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ —Å –Ω–µ–±–æ–ª—å—à–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω–æ

- **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∏–ª—è** —á–µ—Ä–µ–∑ `/set_personality`

- **–†–∞–±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö** (–≤–∫–ª—é—á–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π `/enable` –∞–¥–º–∏–Ω–æ–º)

- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–∏–∞–ª–æ–≥–æ–≤ –≤ PostgreSQL

## –ö–æ–º–∞–Ω–¥—ã

–ö–æ–º–∞–Ω–¥–∞              | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç
---------------------|----------------------------------------------------
`/start`             | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞
`/help`              | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
`/enable`            | –í–∫–ª—é—á–∏—Ç—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
`/disable`           | –í—ã–∫–ª—é—á–∏—Ç—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–µ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
`/reset`             | –°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç GPT
`/set_personality ‚Ä¶` | –ó–∞–¥–∞—Ç—å —Å–≤–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –±–æ—Ç—É
`/dontwritefirst`    | –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –±–æ—Ç—É –ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—ã–º
`/writefirst`        | –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–Ω–æ–≤–∞ –ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—ã–º
`/mood`              | –ü–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–æ—Ç –∑–∞–ø–æ–º–Ω–∏–ª
`/clear_mood`        | –û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- PostgreSQL (–ª—é–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏)

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install python-telegram-bot==20.* \
    psycopg2-binary \
    python-decouple \
    openai==1.*

–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

TELEGRAM_TOKEN=123456:AAF...
OPENAI_API_KEY=sk-...

DB_HOST=127.0.0.1
DB_PORT=5432
DB_NAME=companion_bot
DB_USER=postgres
DB_PASSWORD=yourpassword

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

voices/
‚îú‚îÄ‚îÄ checkin_morning/
‚îÇ   ‚îú‚îÄ‚îÄ —É—Ç—Ä–æ1.ogg
‚îÇ   ‚îú‚îÄ‚îÄ —É—Ç—Ä–æ2.ogg
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ checkin_evening/
    ‚îú‚îÄ‚îÄ –≤–µ—á–µ—Ä1.ogg
    ‚îî‚îÄ‚îÄ ...


–ó–∞–ø—É—Å–∫

python3 bot.py
# –∏–ª–∏
python3 -m bot    


## –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –≤ –∫–æ–¥–µ

–í—Å–µ —ç—Ç–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ —Ä—è–¥–æ–º —Å —Å–µ–∫—Ü–∏–µ–π `# ---------------------- CONFIG ----------------------`

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                            | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é     | –ß—Ç–æ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç / –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
--------------------------------------|----------------------------|---------------------------------------------
`RANDOM_GPT_RESPONSE_CHANCE`          | `1 / 80` ‚âà 1.25%           | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–ª—É—á–∞–π–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç GPT –Ω–∞ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–±–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –±–µ–∑ —Ä–µ–ø–ª–∞—è)
`CHEAP_REACTION_CHANCE`               | `1 / 12` ‚âà 8.3%            | –®–∞–Ω—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—É—é (–¥–µ—à—ë–≤—É—é) —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª GPT
`CHECK_LONELY_INTERVAL_SEC`           | `60 * 60 * 3` (3 —á–∞—Å–∞)     | –ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–º –¥–∞–≤–Ω–æ –Ω–µ –ø–∏—Å–∞–ª–∏
`LOCAL_TZ`                            | `Europe/Podgorica`         | –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ¬´—É—Ç—Ä–æ / –≤–µ—á–µ—Ä / —Å–µ–≥–æ–¥–Ω—è¬ª
`VOICE_DIR_MORNING` / `VOICE_DIR_EVENING` | –ø—É—Ç–∏ –∫ –ø–∞–ø–∫–∞–º          | –ì–¥–µ –ª–µ–∂–∞—Ç .ogg —Ñ–∞–π–ª—ã –¥–ª—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —á–µ–∫-–∏–Ω–æ–≤

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö:
- `pick_checkin_text()` ‚Äî —Ç–µ–∫—Å—Ç—ã —É—Ç—Ä–µ–Ω–Ω–∏—Ö / –≤–µ—á–µ—Ä–Ω–∏—Ö / –¥–Ω–µ–≤–Ω—ã—Ö —á–µ–∫-–∏–Ω–æ–≤
- `CHEAP_REACTIONS` ‚Äî —Å–ª–æ–≤–∞—Ä—å –±—ã—Å—Ç—Ä—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –±–µ–∑ GPT
- `MOOD_PATTERNS` ‚Äî –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
- `default_personality` ‚Äî –±–∞–∑–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∞ –°–≤–µ—Ç–ª–∞–Ω—ã

## –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–∏–¥–µ–∏ –Ω–∞ –±—É–¥—É—â–µ–µ)

- –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∑–∞ –Ω–µ–¥–µ–ª—é / –º–µ—Å—è—Ü (`/moodstats`)
- –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø–æ–¥ —á–µ–∫-–∏–Ω–∞–º–∏ (¬´–≤—Å—ë –æ–∫¬ª, ¬´–ø–ª–æ—Ö–æ¬ª, ¬´—Ä–∞—Å—Å–∫–∞–∂—É¬ª)
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –¥–µ–ª–∞—Ö / –ø—Ä–∏–≤—ã—á–∫–∞—Ö (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –ø–æ–ø—Ä–æ—Å–∏—Ç)
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–∞–ª–µ–Ω—å–∫—É—é –º–æ–¥–µ–ª—å –∏–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ GPT-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—ç–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ / —è–∑—ã–∫–∞)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- –õ—ë–≥–∫–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ / —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ú–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥ –∫–∞–∫ —É–≥–æ–¥–Ω–æ ‚Äî –¥–ª—è —Å–µ–±—è, –¥–ª—è –¥—Ä—É–∑–µ–π, –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.  
–ï—Å–ª–∏ –±—É–¥–µ—à—å –≤—ã–∫–ª–∞–¥—ã–≤–∞—Ç—å —Å–≤–æ—é –≤–µ—Ä—Å–∏—é –ø—É–±–ª–∏—á–Ω–æ ‚Äî –±—É–¥–µ—Ç –ø—Ä–∏—è—Ç–Ω–æ, –µ—Å–ª–∏ —É–∫–∞–∂–µ—à—å, —á—Ç–æ –æ—Å–Ω–æ–≤–∞ –≤–∑—è—Ç–∞ –æ—Ç—Å—é–¥–∞ üòä

–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è —Å–æ –°–≤–µ—Ç–ª–∞–Ω–æ–π üíõ  
–ü—É—Å—Ç—å –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç —á—å–∏-—Ç–æ –¥–Ω–∏ —á—É—Ç—å —Ç–µ–ø–ª–µ–µ.