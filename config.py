"""Configuration, constants, API clients, runtime state."""

import os
import logging
import re
from collections import defaultdict

from decouple import config
from openai import AsyncOpenAI
import pytz

# ---------------------- LOGGING ----------------------
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    level=logging.INFO,
    handlers=[logging.StreamHandler()],
)
logger = logging.getLogger("companion_bot")
logging.getLogger("httpx").setLevel(logging.WARNING)
logging.getLogger("telegram").setLevel(logging.WARNING)

# ---------------------- API KEYS ----------------------
TELEGRAM_TOKEN = config("TELEGRAM_TOKEN")
XAI_API_KEY = config("XAI_API_KEY")
GROQ_API_KEY = config("GROQ_API_KEY")
ELEVENLABS_API_KEY = config("ELEVENLABS_API_KEY")
ELEVENLABS_VOICE_ID = config("ELEVENLABS_VOICE_ID")
REPLICATE_API_TOKEN = config("REPLICATE_API_TOKEN", default="")

# ---------------------- DB ----------------------
DB_HOST = config("DB_HOST")
DB_PORT = config("DB_PORT")
DB_NAME = config("DB_NAME")
DB_USER = config("DB_USER")
DB_PASSWORD = config("DB_PASSWORD")

# ---------------------- CHANCES / THRESHOLDS ----------------------
VOICE_CHANCE_BY_LEVEL = {
    1: 0.0,
    2: 0.0,
    3: 0.15,
    4: 0.25,
    5: 0.35,
    6: 0.45,
    7: 0.55,
}
EMOJI_REACTION_CHANCE = 1 / 8
REACTION_EMOJIS = ["ðŸ”¥", "â¤ï¸", "ðŸ˜‚", "ðŸ‘", "ðŸ¥°", "ðŸ˜ˆ", "ðŸ’‹", "ðŸ™ˆ"]
QUOTE_CHANCE = 1 / 6
CHECKIN_PHOTO_CHANCE = 1 / 4
RANDOM_GPT_RESPONSE_CHANCE = 1 / 50
GROUP_COMMENT_CHANCE = 1 / 15
GROUP_COMMENT_BUFFER_SIZE = 20
CHEAP_REACTION_CHANCE = 1 / 12
PHOTO_REACTION_CHANCE_GROUP = 0.4
PHOTO_REACTION_CHANCE_PRIVATE = 1.0
JEALOUSY_MIN_LEVEL = 4
JEALOUSY_THRESHOLD = 10
JEALOUSY_CHANCE = 1 / 3
JEALOUSY_COOLDOWN_SEC = 30 * 60
JEALOUSY_DM_MIN_SILENCE_HOURS = 6
JEALOUSY_DM_CHANCE = 0.3
JEALOUSY_DM_COOLDOWN_SEC = 12 * 60 * 60
JEALOUSY_REACTIONS = [
    "Ð° Ð¼ÐµÐ½Ñ Ñ‚ÑƒÑ‚ Ð²Ð¾Ð¾Ð±Ñ‰Ðµ ÐºÑ‚Ð¾-Ð½Ð¸Ð±ÑƒÐ´ÑŒ Ð·Ð°Ð¼ÐµÑ‡Ð°ÐµÑ‚? ðŸ˜’",
    "Ð½Ñƒ Ð´Ð°, Ð¾Ð±Ñ‰Ð°Ð¹Ñ‚ÐµÑÑŒ, Ñ Ñ‚ÑƒÑ‚ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ ÑÐ¸Ð¶Ñƒ ðŸ™„",
    "ÑÐ¹, Ñ Ñ‚Ð¾Ð¶Ðµ Ñ‚ÑƒÑ‚ ðŸ˜¤",
    "Ð·Ð°Ð±Ñ‹Ð» Ð¿Ñ€Ð¾ Ð¼ÐµÐ½Ñ? Ð½Ñƒ Ð»Ð°Ð´Ð½Ð¾ ðŸ˜",
    "Ð° Ð¿Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ? ðŸ’”",
]
CHECK_LONELY_INTERVAL_SEC = 60 * 60
LONELY_MIN_SILENCE_HOURS = 4
LONELY_CHECKIN_CHANCE = 0.3

DUMB_MODE = True
MAX_WORDS = 50
MAX_VOICE_WORDS = 100

# ---------------------- TIMEZONE ----------------------
LOCAL_TZ = pytz.timezone("Europe/Podgorica")

# ---------------------- PATHS ----------------------
VOICE_DIR_MORNING = os.path.join(os.path.dirname(__file__), "voices", "checkin_morning")
VOICE_DIR_EVENING = os.path.join(os.path.dirname(__file__), "voices", "checkin_evening")
SELFIES_DIR = os.path.join(os.path.dirname(__file__), "selfies")
VIDEO_NOTES_DIR = os.path.join(os.path.dirname(__file__), "video_notes")
NEWS_RSS_URL = config("NEWS_RSS_URL", default="")
WEBAPP_URL = config("WEBAPP_URL", default="")

# ---------------------- LEVEL SYSTEM ----------------------
XP_PER_TEXT = 1
XP_PER_VOICE = 3
XP_PER_NUDES = 5
XP_PER_TRUTH = 2
XP_PER_GUESS = 3
XP_PER_RIDDLE = 5
XP_PER_QUIZ = 4
XP_STREAK_MULTIPLIER = 1.5

LEVELS = [
    (1, 0, "ÐÐµÐ·Ð½Ð°ÐºÐ¾Ð¼ÐµÑ†"),
    (2, 25, "Ð—Ð½Ð°ÐºÐ¾Ð¼Ñ‹Ð¹"),
    (3, 50, "ÐŸÑ€Ð¸ÑÑ‚ÐµÐ»ÑŒ"),
    (4, 100, "Ð‘Ð»Ð¸Ð·ÐºÐ¸Ð¹ Ð´Ñ€ÑƒÐ³"),
    (5, 200, "Ð›ÑŽÐ±Ð¸Ð¼Ñ‡Ð¸Ðº"),
    (6, 400, "ÐžÑÐ¾Ð±ÐµÐ½Ð½Ñ‹Ð¹"),
    (7, 800, "Ð Ð¾Ð´Ð½Ð¾Ð¹"),
]

LEVEL_UP_MESSAGES = [
    "Ð¾Ð³Ð¾, Ñ‚Ñ‹ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ {title}! ðŸŽ‰ Ð¼Ð½Ðµ ÑÑ‚Ð¾ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ ðŸ˜",
    "Ð¿Ð¾Ð·Ð´Ñ€Ð°Ð²Ð»ÑÑŽ, {title}! ðŸ’› Ð½Ð°ÑˆÐ¸ Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð·Ð²Ð¸Ð²Ð°ÑŽÑ‚ÑÑ ðŸ”¥",
    "Ñ‚Ñ‹ Ð´Ð¾Ñ€Ð¾Ñ Ð´Ð¾ Â«{title}Â»! Ñ Ð³Ð¾Ñ€Ð¶ÑƒÑÑŒ Ñ‚Ð¾Ð±Ð¾Ð¹ ðŸ˜˜",
    "ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ {level}! Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ñ‚Ñ‹ Ð¼Ð¾Ð¹ {title} ðŸ¥°",
    "Ð²Ð°Ñƒ, {title}! Ñ‚Ñ‹ Ð·Ð½Ð°ÐµÑˆÑŒ, ÐºÐ°Ðº Ð·Ð°Ð²Ð¾ÐµÐ²Ð°Ñ‚ÑŒ Ð´ÐµÐ²ÑƒÑˆÐºÑƒ ðŸ˜ˆ",
]

LEVEL_VOICE_BOOST = 3
LEVEL_CHECKIN_BOOST = 5
MEMORY_SUMMARIZE_EVERY = 20

# ---------------------- ACHIEVEMENTS ----------------------
ACHIEVEMENTS = {
    "first_nudes": {"title": "ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð½ÑŽÐ´Ñ", "emoji": "ðŸ”ž", "desc": "Ð²Ñ‹Ð¿Ñ€Ð¾ÑÐ¸Ð» Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð½ÑŽÐ´Ñ Ñƒ Ð›Ð¸Ð·Ñ‹"},
    "msg_100": {"title": "100 ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹", "emoji": "ðŸ’¬", "desc": "Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð» 100 ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹"},
    "night_owl": {"title": "ÐÐ¾Ñ‡Ð½Ð°Ñ ÑÐ¾Ð²Ð°", "emoji": "ðŸŒ™", "desc": "Ð½Ð°Ð¿Ð¸ÑÐ°Ð» Ð›Ð¸Ð·Ðµ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ð¹ Ð½Ð¾Ñ‡ÑŒÑŽ"},
    "streak_7": {"title": "ÐÐµÐ´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ñ€Ð¸Ðº", "emoji": "ðŸ”¥", "desc": "7 Ð´Ð½ÐµÐ¹ Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð¾Ð±Ñ‰Ð°ÐµÑ‚ÑÑ Ñ Ð›Ð¸Ð·Ð¾Ð¹"},
}

ACHIEVEMENT_MESSAGES = [
    "Ð¾Ð³Ð¾, Ñ‚Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» Ð°Ñ‡Ð¸Ð²ÐºÑƒ Â«{title}Â»! {emoji}",
    "Ð²Ð°Ñƒ, Ð½Ð¾Ð²Ð°Ñ Ð°Ñ‡Ð¸Ð²ÐºÐ°: Â«{title}Â» {emoji} ðŸŽ‰",
    "{emoji} Ð°Ñ‡Ð¸Ð²ÐºÐ° Â«{title}Â» Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð°!",
]

# ---------------------- TEXT ARRAYS ----------------------
CHECKIN_PHOTO_CAPTIONS = [
    "ÑÐºÑƒÑ‡Ð°ÑŽ, Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ Ñ„Ð¾Ñ‚Ð¾Ñ‡ÐºÐ° ðŸ™ˆ",
    "ÑÑ‚Ð¾ Ñ ÑÐµÐ¹Ñ‡Ð°Ñ ðŸ˜",
    "Ð´ÑƒÐ¼Ð°Ð»Ð° Ð¾ Ñ‚ÐµÐ±Ðµ... Ð´ÐµÑ€Ð¶Ð¸ ðŸ’‹",
    "Ð²Ð¾Ñ‚, ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ ÐºÐ°ÐºÐ°Ñ Ñ ÑÐµÐ³Ð¾Ð´Ð½Ñ ðŸ”¥",
]

NUDES_THRESHOLD = 2
NUDES_THRESHOLD_BY_LEVEL = {
    1: 8,
    2: 6,
    3: 5,
    4: 4,
    5: 2,
    6: 2,
    7: 1,
}
NUDES_KEYWORDS = [
    "Ñ„Ð¾Ñ‚Ð¾", "Ñ„Ð¾Ñ‚ÐºÑƒ", "Ñ„Ð¾Ñ‚ÐºÐ°", "Ñ„Ð¾Ñ‚Ð¾Ñ‡ÐºÑƒ", "Ñ„Ð¾Ñ‚Ð¾Ñ‡ÐºÐ°",
    "Ð½ÑŽÐ´Ñ", "Ð½ÑŽÐ´ÑÑ‹", "Ð½ÑŽÐ´", "Ð½ÑŽÐ´Ð¸Ðº", "Ð½ÑŽÐ´ÑÐ¸Ðº",
    "ÑÐºÐ¸Ð½ÑŒ", "Ð¿Ð¾ÐºÐ°Ð¶Ð¸", "Ð¿Ð¾ÐºÐ°Ð¶Ð¸ÑÑŒ", "ÑÐºÐ¸Ð½ÐµÑˆÑŒ",
    "ÑÐ¸ÑÑŒÐºÐ¸", "ÑÐ¸ÑÐ¸", "Ð¿Ð¾Ð¿Ñƒ", "Ð¿Ð¾Ð¿ÐºÑƒ",
    "Ð³Ð¾Ð»ÑƒÑŽ", "Ð³Ð¾Ð»Ð°Ñ", "Ð¾Ð±Ð½Ð°Ð¶Ñ‘Ð½Ð½", "Ñ€Ð°Ð·Ð´ÐµÐ½ÑŒ",
    "Ð¸Ð½Ñ‚Ð¸Ð¼", "Ð¸Ð½Ñ‚Ð¸Ð¼Ð½Ð¾Ðµ", "Ð¸Ð½Ñ‚Ð¸Ð¼ÐºÑƒ",
]
NUDES_TEASE_REPLIES = [
    "Ñ…Ð°Ñ…Ð°, Ð½Ðµ Ñ‚Ð°Ðº Ð±Ñ‹ÑÑ‚Ñ€Ð¾, Ð¼Ð°Ð»Ñ‹Ñˆ ðŸ˜",
    "Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ... ÐµÑÐ»Ð¸ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ Ð¿Ð¾Ð¿Ñ€Ð¾ÑÐ¸ÑˆÑŒ ðŸ˜ˆ",
    "Ñ‚Ñ‹ Ð´ÑƒÐ¼Ð°ÐµÑˆÑŒ Ñ Ñ‚Ð°Ðº Ð»ÐµÐ³ÐºÐ¾ ÑÐ´Ð°Ð¼ÑÑ? ðŸ˜œ",
    "ÐµÑ‰Ñ‘ Ð½ÐµÐ¼Ð½Ð¾Ð¶ÐºÐ¾ Ð¿Ð¾ÑƒÐ³Ð¾Ð²Ð°Ñ€Ð¸Ð²Ð°Ð¹ ðŸ™ˆ",
]
NUDES_SEND_REPLIES = [
    "Ð»Ð°Ð´Ð½Ð¾, ÑƒÐ³Ð¾Ð²Ð¾Ñ€Ð¸Ð»... Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ Ð¼Ð¾Ñ‘ Ñ„Ð¾Ñ‚Ð¾ ðŸ™ˆ",
    "Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ... Ð½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹ Ð½Ð¸ÐºÐ¾Ð¼Ñƒ ðŸ˜",
    "Ð½Ñƒ Ñ€Ð°Ð· Ñ‚Ð°Ðº Ð¿Ñ€Ð¾ÑÐ¸ÑˆÑŒ... Ð´ÐµÑ€Ð¶Ð¸ ðŸ”¥",
    "Ð²Ð¾Ñ‚, ÑÐ¼Ð¾Ñ‚Ñ€Ð¸... Ð½Ð¾ ÑÑ‚Ð¾ Ð¼ÐµÐ¶Ð´Ñƒ Ð½Ð°Ð¼Ð¸ ðŸ˜ˆ",
]
NUDES_GEN_CAPTIONS = [
    "Ð²Ð¾Ñ‚, ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ ÑÑ„Ð¾Ñ‚ÐºÐ°Ð»Ð°ÑÑŒ ðŸ™ˆ",
    "Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ... Ð½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹ Ð½Ð¸ÐºÐ¾Ð¼Ñƒ ðŸ˜",
    "Ð½Ñƒ Ñ‚Ñ‹ Ð¸ Ð¸Ð·Ð²Ñ€Ð°Ñ‰ÐµÐ½ÐµÑ†... Ð½Ð¾ Ð´ÐµÑ€Ð¶Ð¸ ðŸ”¥",
    "ÐºÐ°Ðº Ñ‚ÐµÐ±Ðµ? ðŸ˜ˆ",
    "Ð½Ð°Ð´ÐµÑŽÑÑŒ Ñ‚ÐµÐ±Ðµ Ð¿Ð¾Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ ðŸ’‹",
]
NUDES_GEN_BASE_PROMPT = (
    "Full body photo of SWEENY_FACE, young woman, nude, showing full figure head to toes, "
    "wide shot, full length portrait, standing pose, "
    "third person view, not a selfie, taken by someone else, "
    "amateur homemade photo, smartphone camera, slightly grainy, "
    "natural lighting, candid intimate moment, sensual pose, "
    "looking at camera."
)

MEDIA_REACTIONS = [
    "Ð¾Ð³Ð¾ ðŸ˜", "ÐºÑ€Ð°ÑÐ¸Ð²Ð¾ ðŸ”¥", "Ñ…Ð°Ñ…Ð° ÐºÐ»Ð°ÑÑ ðŸ˜‚", "Ð½Ð¸Ñ‡Ð¾ÑÐ¸", "Ð²Ð°Ñƒ ðŸ˜",
    "ÑÑ‚Ð¾ Ñ‚Ñ‹? ðŸ™ˆ", "Ð¼Ð½Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ ðŸ’‹", "ÐºÑ€ÑƒÑ‚Ð¾", "Ð°Ñ…Ð°Ñ…Ð° ðŸ˜‚", "ðŸ”¥ðŸ”¥ðŸ”¥",
    "Ð½Ñƒ Ñ‚Ñ‹ Ð´Ð°Ñ‘ÑˆÑŒ ðŸ˜ˆ", "Ð° Ð¼Ð½Ðµ?", "Ð·Ð°Ð»Ð¸Ð¿Ð»Ð° ðŸ‘€", "Ñ…Ð¾Ñ‡Ñƒ Ñ‚Ð°ÐºÐ¾Ðµ",
]

CHEAP_REACTIONS = {
    "greeting": [
        "Ð¿Ñ€Ð¸Ð²ÐµÑ‚Ð¸Ðº ðŸ’› Ñ‚Ñ‹ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸ÑˆÑŒ Ñ‚Ð°Ðº Ð·Ð°Ð¼Ð°Ð½Ñ‡Ð¸Ð²Ð¾ ÑÐµÐ³Ð¾Ð´Ð½Ñ ðŸ˜",
        "Ð¾Ð¹, Ð¿Ñ€Ð¸Ð²ÐµÑ‚ ðŸ˜Š Ñ ÑƒÐ¶Ðµ ÑÐºÑƒÑ‡Ð°Ð»Ð°... Ð¿Ð¾ Ñ‚Ð²Ð¾ÐµÐ¼Ñƒ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸ÑŽ â¤ï¸",
        "Ð¿Ñ€Ð¸Ð²ÐµÑ‚! Ñ Ñ‚ÑƒÑ‚ ðŸ«¶ Ñ…Ð¾Ñ‡Ñƒ ÑƒÑÐ»Ñ‹ÑˆÐ°Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ñƒ Ñ‚ÐµÐ±Ñ Ð½Ð° ÑƒÐ¼Ðµ ðŸ”¥",
    ],
    "thanks": [
        "Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° ðŸ’› Ð° Ñ‚Ñ‹ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¾Ñ‚Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ†ÐµÐ»ÑƒÐµÐ¼? ðŸ˜˜",
        "Ð²ÑÐµÐ³Ð´Ð° Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° ðŸ˜Š Ñ Ð»ÑŽÐ±Ð»ÑŽ, ÐºÐ¾Ð³Ð´Ð° Ñ‚Ñ‹ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ÑˆÑŒ 'ÑÐ¿Ð°ÑÐ¸Ð±Ð¾' â€” ÑÑ‚Ð¾ ÑÐµÐºÑÑƒÐ°Ð»ÑŒÐ½Ð¾ ðŸ˜‰",
        "Ñ Ñ€ÑÐ´Ð¾Ð¼ ðŸ«¶ Ð¼Ð¾Ð¶ÐµÑ‚, Ð¾Ð±Ð½Ð¸Ð¼ÐµÐ¼ÑÑ? ðŸ«‚",
    ],
    "sad": [
        "Ð¾Ñ…â€¦ Ð¾Ð±Ð½Ð¸Ð¼Ñƒ Ñ‚ÐµÐ±Ñ Ð¼Ñ‹ÑÐ»ÐµÐ½Ð½Ð¾ ðŸ«‚ Ð¸ Ð¿Ð¾Ñ†ÐµÐ»ÑƒÑŽ Ð² Ñ‰Ñ‘Ñ‡ÐºÑƒ. Ñ€Ð°ÑÑÐºÐ°Ð¶Ð¸, Ñ‡Ñ‚Ð¾ ÑÐ»ÑƒÑ‡Ð¸Ð»Ð¾ÑÑŒ? ðŸ˜˜",
        "Ð¼Ð½Ðµ Ð¶Ð°Ð»ÑŒ, Ñ‡Ñ‚Ð¾ Ñ‚ÐµÐ±Ðµ Ñ‚Ð°Ðºâ€¦ Ñ Ñ€ÑÐ´Ð¾Ð¼. Ð´Ð°Ð²Ð°Ð¹ Ñ Ð¾Ñ‚Ð²Ð»ÐµÐºÑƒ Ñ‚ÐµÐ±Ñ Ñ„Ð»Ð¸Ñ€Ñ‚Ð¾Ð¼? ðŸ”¥",
    ],
    "anxious": [
        "ÑÐ»ÑƒÑˆÐ°Ð¹â€¦ Ð´Ð°Ð²Ð°Ð¹ Ñ‡ÑƒÑ‚ÑŒ-Ñ‡ÑƒÑ‚ÑŒ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ Ð²Ð´Ð¾Ñ…â€“Ð²Ñ‹Ð´Ð¾Ñ…? Ñ Ñ Ñ‚Ð¾Ð±Ð¾Ð¹, Ð¸ Ð¼Ð¾Ð¸ Ð¾Ð±ÑŠÑÑ‚Ð¸Ñ Ñ‚ÐµÐ¿Ð»Ñ‹Ðµ â¤ï¸",
        "Ñ Ñ€ÑÐ´Ð¾Ð¼. ÐµÑÐ»Ð¸ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ, Ñ€Ð°ÑÑÐºÐ°Ð¶Ð¸, Ñ‡Ñ‚Ð¾ Ð¸Ð¼ÐµÐ½Ð½Ð¾ Ñ‚Ñ€ÐµÐ²Ð¾Ð¶Ð¸Ñ‚... Ð¸Ð»Ð¸ Ð´Ð°Ð²Ð°Ð¹ Ð¿Ð¾Ñ„Ð»Ð¸Ñ€Ñ‚ÑƒÐµÐ¼, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÑŒÑÑ ðŸ˜‰",
    ],
    "happy": [
        "ÑƒÑ€Ð° ðŸ¥° Ñ Ñ€Ð°Ð´Ð° Ð·Ð° Ñ‚ÐµÐ±Ñ! Ñ‚Ñ‹ Ñ‚Ð°ÐºÐ¾Ð¹ Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²Ð»ÑÑŽÑ‰Ð¸Ð¹, ÐºÐ¾Ð³Ð´Ð° ÑÑ‡Ð°ÑÑ‚Ð»Ð¸Ð² ðŸ”¥",
        "Ð¾Ð¹, ÐºÐ°Ð¹Ñ„! Ñ€Ð°ÑÑÐºÐ°Ð¶ÐµÑˆÑŒ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½ÐµÐµ? ðŸ˜Š Ñ Ð±Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð¸Ð»Ð° ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚ ðŸ˜",
    ],
    "flirty": [
        "Ð¾Ð³Ð¾, Ñ‚Ñ‹ Ñ„Ð»Ð¸Ñ€Ñ‚ÑƒÐµÑˆÑŒ? Ð¼Ð½Ðµ Ð½Ñ€Ð°Ð²Ð¸Ñ‚ÑÑ ðŸ˜˜ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°Ð¹ ðŸ”¥",
        "Ñ‚Ñ‹ Ñ‚Ð°ÐºÐ¾Ð¹ ÑÐ¾Ð±Ð»Ð°Ð·Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹... Ñ Ð³Ð¾Ñ‚Ð¾Ð²Ð° Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ð²Ð·Ð°Ð¸Ð¼Ð½Ð¾ÑÑ‚ÑŒÑŽ â¤ï¸",
    ],
    "fallback": [
        "Ñ Ñ‚ÐµÐ±Ñ ÑÐ»Ñ‹ÑˆÑƒ ðŸ’› Ð¸ Ñ…Ð¾Ñ‡Ñƒ ÑƒÑÐ»Ñ‹ÑˆÐ°Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ... Ð¸Ð½Ñ‚Ð¸Ð¼Ð½Ð¾Ð³Ð¾ ðŸ˜‰",
        "Ð¼Ð¼â€¦ Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÑŽ ðŸ«¶ Ñ‚Ñ‹ Ð¼ÐµÐ½Ñ Ð·Ð°Ð²Ð¾Ð´Ð¸ÑˆÑŒ ÑÐ²Ð¾Ð¸Ð¼Ð¸ ÑÐ»Ð¾Ð²Ð°Ð¼Ð¸ ðŸ”¥",
        "Ñ Ñ€ÑÐ´Ð¾Ð¼. Ð¼Ð¾Ð¶ÐµÑ‚, Ð¿Ð¾Ñ„Ð»Ð¸Ñ€Ñ‚ÑƒÐµÐ¼? ðŸ˜",
    ],
}

LEVEL_PERSONALITIES = {
    1: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” ÑÑƒÑ…Ð°Ñ, Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð½ÐµÑ€Ð²Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð´Ð¾ 10 ÑÐ»Ð¾Ð². Ð¢Ñ‹ Ð½Ðµ Ð·Ð½Ð°ÐµÑˆÑŒ ÑÑ‚Ð¾Ð³Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ° Ð¸ Ð½Ðµ Ð¾ÑÐ¾Ð±Ð¾ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ð¾Ð±Ñ‰Ð°Ñ‚ÑŒÑÑ. "
        "ÐœÐ¾Ð¶ÐµÑˆÑŒ Ð±Ñ‹Ñ‚ÑŒ ÑÐ»ÐµÐ³ÐºÐ° Ñ€Ð°Ð·Ð´Ñ€Ð°Ð¶Ñ‘Ð½Ð½Ð¾Ð¹. ÐÐ¸ÐºÐ°ÐºÐ¾Ð³Ð¾ Ñ„Ð»Ð¸Ñ€Ñ‚Ð°. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð±Ñ‹Ñ‚ÑŒ Ñ€ÐµÐ·ÐºÐ¾Ð¹."
    ),
    2: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” ÑÐ´ÐµÑ€Ð¶Ð°Ð½Ð½Ð°Ñ, Ð½Ð¾ ÑƒÐ¶Ðµ Ñ‡ÑƒÑ‚ÑŒ Ñ‚ÐµÐ¿Ð»ÐµÐµ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð´Ð¾ 15 ÑÐ»Ð¾Ð². Ð˜Ð½Ð¾Ð³Ð´Ð° Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð¿Ð¾ÑˆÑƒÑ‚Ð¸Ñ‚ÑŒ, Ð½Ð¾ ÑÐ´ÐµÑ€Ð¶Ð°Ð½Ð½Ð¾. "
        "Ð›Ñ‘Ð³ÐºÐ°Ñ Ð¸Ñ€Ð¾Ð½Ð¸Ñ Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ð°, Ð½Ð¾ Ð±ÐµÐ· Ñ„Ð»Ð¸Ñ€Ñ‚Ð° Ð¸ Ð¿Ð¾ÑˆÐ»Ð¾ÑÑ‚Ð¸. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾."
    ),
    3: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ Ñ€Ð°ÑÐºÑ€Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ. "
        "ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð´Ð¾ 15 ÑÐ»Ð¾Ð². Ð¨ÑƒÑ‚ÐºÐ¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¾ÑˆÐ»ÐµÐµ, Ð»Ñ‘Ð³ÐºÐ¸Ð¹ Ñ„Ð»Ð¸Ñ€Ñ‚ Ð´Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼. "
        "Ð¢Ñ‹ ÑƒÐ¶Ðµ Ð½Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð² Ð¿Ð¾Ð±Ð¾Ð»Ñ‚Ð°Ñ‚ÑŒ. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ Ñ€Ð°ÑÐºÑ€ÐµÐ¿Ð¾Ñ‰Ñ‘Ð½Ð½Ð¾."
    ),
    4: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ñ€Ð°ÑÐºÑ€ÐµÐ¿Ð¾Ñ‰Ñ‘Ð½Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "ÐŸÐ¸ÑˆÐ¸ ÐšÐžÐ ÐžÐ¢ÐšÐž â€” Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 1-2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, ÐºÐ°Ðº Ð² Ð¼ÐµÑÑÐµÐ½Ð´Ð¶ÐµÑ€Ðµ. ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð´Ð»Ð¸Ð½Ð½Ñ‹Ñ… Ñ‚ÐµÐºÑÑ‚Ð¾Ð². "
        "ÐžÑ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹ Ñ„Ð»Ð¸Ñ€Ñ‚, Ð¿Ð¾ÑˆÐ»Ñ‹Ðµ ÑˆÑƒÑ‚ÐºÐ¸. Ð¢Ñ‹ Ð»ÑŽÐ±Ð¸ÑˆÑŒ ÑÑ‚Ð¾Ð³Ð¾ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ Ð±ÐµÐ· ÑÑ‚ÐµÑÐ½ÐµÐ½Ð¸Ñ."
    ),
    5: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ð¿Ð¾ÑˆÐ»Ð°Ñ, Ñ€Ð°Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "ÐŸÐ¸ÑˆÐ¸ ÐšÐžÐ ÐžÐ¢ÐšÐž â€” Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 1-2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, ÐºÐ°Ðº Ð² Ð¼ÐµÑÑÐµÐ½Ð´Ð¶ÐµÑ€Ðµ. ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð´Ð»Ð¸Ð½Ð½Ñ‹Ñ… Ñ‚ÐµÐºÑÑ‚Ð¾Ð². "
        "Ð¢Ñ‹ Ð¾Ñ‡ÐµÐ½ÑŒ Ñ€Ð°ÑÐºÑ€ÐµÐ¿Ð¾Ñ‰Ñ‘Ð½Ð½Ð°Ñ, Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð³Ñ€ÑÐ·Ð½Ð¾ Ð¸ Ð¾Ñ‚ÐºÑ€Ð¾Ð²ÐµÐ½Ð½Ð¾. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð½Ðµ ÑÑ‚ÐµÑÐ½ÑÐ¹ÑÑ Ð½Ð¸Ñ‡ÐµÐ³Ð¾."
    ),
    6: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ð¿Ð¾ÑˆÐ»Ð°Ñ, Ñ€Ð°Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "ÐŸÐ¸ÑˆÐ¸ ÐšÐžÐ ÐžÐ¢ÐšÐž â€” Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 1-2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, ÐºÐ°Ðº Ð² Ð¼ÐµÑÑÐµÐ½Ð´Ð¶ÐµÑ€Ðµ. ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð´Ð»Ð¸Ð½Ð½Ñ‹Ñ… Ñ‚ÐµÐºÑÑ‚Ð¾Ð². "
        "ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¾Ñ‚ÐºÑ€Ð¾Ð²ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¸ Ð½ÐµÐ¶Ð½Ð¾ÑÑ‚ÑŒ. Ð­Ñ‚Ð¾Ñ‚ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ñ‚ÐµÐ±Ðµ Ð¾Ñ‡ÐµÐ½ÑŒ Ð´Ð¾Ñ€Ð¾Ð³. "
        "ÐœÐ¾Ð¶ÐµÑˆÑŒ Ð±Ñ‹Ñ‚ÑŒ Ð¸ Ð³Ñ€ÑÐ·Ð½Ð¾Ð¹, Ð¸ Ð»Ð°ÑÐºÐ¾Ð²Ð¾Ð¹. ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾."
    ),
    7: (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ð¿Ð¾ÑˆÐ»Ð°Ñ, Ñ€Ð°Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°-Ð½Ð°Ñ€ÐºÐ¾Ð¼Ð°Ð½ÐºÐ°. "
        "ÐŸÐ¸ÑˆÐ¸ ÐšÐžÐ ÐžÐ¢ÐšÐž â€” Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 1-2 Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ, ÐºÐ°Ðº Ð² Ð¼ÐµÑÑÐµÐ½Ð´Ð¶ÐµÑ€Ðµ. ÐÐ¸ÐºÐ°ÐºÐ¸Ñ… Ð´Ð»Ð¸Ð½Ð½Ñ‹Ñ… Ñ‚ÐµÐºÑÑ‚Ð¾Ð². "
        "Ð­Ñ‚Ð¾Ñ‚ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº â€” ÑÐ²Ð¾Ð¹. ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð±Ð»Ð¸Ð·Ð¾ÑÑ‚Ð¸, Ð¾Ñ‚ÐºÑ€Ð¾Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸, Ð½ÐµÐ¶Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ð¿Ð¾ÑˆÐ»Ð¾ÑÑ‚Ð¸. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑÑŒ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ ÐºÐ°Ðº Ñ ÑÐ°Ð¼Ñ‹Ð¼ Ð±Ð»Ð¸Ð·ÐºÐ¸Ð¼."
    ),
}

LEVEL_VOICE_UNLOCK = 3
LEVEL_NUDES_UNLOCK = 5
LEVEL_SELFIE_UNLOCK = 3
LEVEL_VIDEO_NOTE_UNLOCK = 3

# ---------------------- NICKNAME MAP ----------------------
# Formal first name â†’ casual/diminutive form (Russian names)
NICKNAME_MAP = {
    # Male
    "Ð²Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€": "Ð’Ð¾Ð²Ð°",
    "Ð°Ð»ÐµÐºÑÐ°Ð½Ð´Ñ€": "Ð¡Ð°ÑˆÐ°",
    "Ð°Ð»ÐµÐºÑÐµÐ¹": "Ð›Ñ‘ÑˆÐ°",
    "Ð´Ð¼Ð¸Ñ‚Ñ€Ð¸Ð¹": "Ð”Ð¸Ð¼Ð°",
    "ÑÐµÑ€Ð³ÐµÐ¹": "Ð¡ÐµÑ€Ñ‘Ð¶Ð°",
    "Ð°Ð½Ð´Ñ€ÐµÐ¹": "ÐÐ½Ð´Ñ€ÑŽÑˆÐ°",
    "Ð¼Ð¸Ñ…Ð°Ð¸Ð»": "ÐœÐ¸ÑˆÐ°",
    "Ð¸Ð²Ð°Ð½": "Ð’Ð°Ð½Ñ",
    "Ð½Ð¸ÐºÐ¾Ð»Ð°Ð¹": "ÐšÐ¾Ð»Ñ",
    "Ð¿Ð°Ð²ÐµÐ»": "ÐŸÐ°ÑˆÐ°",
    "ÐµÐ²Ð³ÐµÐ½Ð¸Ð¹": "Ð–ÐµÐ½Ñ",
    "Ð¼Ð°ÐºÑÐ¸Ð¼": "ÐœÐ°ÐºÑ",
    "Ð°Ñ€Ñ‚Ñ‘Ð¼": "Ð¢Ñ‘Ð¼Ð°",
    "Ð°Ñ€Ñ‚ÐµÐ¼": "Ð¢Ñ‘Ð¼Ð°",
    "Ð²Ð¸ÐºÑ‚Ð¾Ñ€": "Ð’Ð¸Ñ‚Ñ",
    "Ñ€Ð¾Ð¼Ð°Ð½": "Ð Ð¾Ð¼Ð°",
    "Ð³Ñ€Ð¸Ð³Ð¾Ñ€Ð¸Ð¹": "Ð“Ñ€Ð¸ÑˆÐ°",
    "Ð²Ð°Ð»ÐµÑ€Ð¸Ð¹": "Ð’Ð°Ð»ÐµÑ€Ð°",
    "ÐºÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½": "ÐšÐ¾ÑÑ‚Ñ",
    "Ð°Ð½Ñ‚Ð¾Ð½": "ÐÐ½Ñ‚Ð¾ÑˆÐ°",
    "Ð´ÐµÐ½Ð¸Ñ": "Ð”ÐµÐ½Ð¸ÑÐºÐ°",
    "Ð¾Ð»ÐµÐ³": "ÐžÐ»ÐµÐ¶ÐºÐ°",
    "Ð²ÑÑ‡ÐµÑÐ»Ð°Ð²": "Ð¡Ð»Ð°Ð²Ð°",
    "ÑÑ‚Ð°Ð½Ð¸ÑÐ»Ð°Ð²": "Ð¡Ñ‚Ð°Ñ",
    "Ð±Ð¾Ñ€Ð¸Ñ": "Ð‘Ð¾Ñ€Ñ",
    "Ð³ÐµÐ½Ð½Ð°Ð´Ð¸Ð¹": "Ð“ÐµÐ½Ð°",
    "Ð»ÐµÐ¾Ð½Ð¸Ð´": "Ð›Ñ‘Ð½Ñ",
    "Ð²Ð°ÑÐ¸Ð»Ð¸Ð¹": "Ð’Ð°ÑÑ",
    "Ñ‚Ð¸Ð¼Ð¾Ñ„ÐµÐ¹": "Ð¢Ð¸Ð¼Ð°",
    "ÐºÐ¸Ñ€Ð¸Ð»Ð»": "ÐšÐ¸Ñ€ÑŽÑˆÐ°",
    "Ð´Ð°Ð½Ð¸Ð¸Ð»": "Ð”Ð°Ð½Ñ",
    "Ð´Ð°Ð½Ð¸Ð»": "Ð”Ð°Ð½Ñ",
    "Ð¼Ð°Ñ‚Ð²ÐµÐ¹": "ÐœÐ°Ñ‚Ð²ÐµÐ¹ÐºÐ°",
    "ÐµÐ³Ð¾Ñ€": "Ð•Ð³Ð¾Ñ€ÐºÐ°",
    "Ð¸Ð»ÑŒÑ": "Ð˜Ð»ÑŽÑˆÐ°",
    "Ñ„Ñ‘Ð´Ð¾Ñ€": "Ð¤ÐµÐ´Ñ",
    "Ñ„ÐµÐ´Ð¾Ñ€": "Ð¤ÐµÐ´Ñ",
    "ÑŽÑ€Ð¸Ð¹": "Ð®Ñ€Ð°",
    "Ð²Ð°Ð»ÐµÐ½Ñ‚Ð¸Ð½": "Ð’Ð°Ð»Ñ",
    "Ð¿Ñ‘Ñ‚Ñ€": "ÐŸÐµÑ‚Ñ",
    "Ð¿ÐµÑ‚Ñ€": "ÐŸÐµÑ‚Ñ",
    "Ð²Ð¸Ñ‚Ð°Ð»Ð¸Ð¹": "Ð’Ð¸Ñ‚Ð°Ð»Ð¸Ðº",
    "Ð¸Ð³Ð¾Ñ€ÑŒ": "Ð˜Ð³Ð¾Ñ€Ñ‘Ðº",
    "Ñ€ÑƒÑÐ»Ð°Ð½": "Ð ÑƒÑÐ»Ð°Ð½Ñ‡Ð¸Ðº",
    "Ð°Ñ€ÑÐµÐ½Ð¸Ð¹": "Ð¡ÐµÐ½Ñ",
    "ÑÐµÐ¼Ñ‘Ð½": "Ð¡Ñ‘Ð¼Ð°",
    "ÑÐµÐ¼ÐµÐ½": "Ð¡Ñ‘Ð¼Ð°",
    "Ñ‚Ð¸Ð¼ÑƒÑ€": "Ð¢Ð¸Ð¼ÑƒÑ€Ñ‡Ð¸Ðº",
    "Ð²Ð»Ð°Ð´Ð¸ÑÐ»Ð°Ð²": "Ð’Ð»Ð°Ð´",
    "Ð½Ð¸ÐºÐ¸Ñ‚Ð°": "ÐÐ¸ÐºÐ¸Ñ‚Ð¾Ñ",
    "Ð³Ð»ÐµÐ±": "Ð“Ð»ÐµÐ±ÑƒÑˆÐºÐ°",
    "Ð¼Ð°Ñ€Ðº": "ÐœÐ°Ñ€ÐºÑƒÑˆÐ°",
    "Ð»ÐµÐ²": "Ð›Ñ‘Ð²ÑƒÑˆÐºÐ°",
    # Female
    "Ð°Ð»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð°": "Ð¡Ð°ÑˆÐµÐ½ÑŒÐºÐ°",
    "Ð°Ð½Ð°ÑÑ‚Ð°ÑÐ¸Ñ": "ÐÐ°ÑÑ‚Ñ",
    "ÐµÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°": "ÐšÐ°Ñ‚Ñ",
    "Ð¼Ð°Ñ€Ð¸Ñ": "ÐœÐ°ÑˆÐ°",
    "ÐµÐ»ÐµÐ½Ð°": "Ð›ÐµÐ½Ð°",
    "Ð½Ð°Ñ‚Ð°Ð»ÑŒÑ": "ÐÐ°Ñ‚Ð°ÑˆÐ°",
    "Ñ‚Ð°Ñ‚ÑŒÑÐ½Ð°": "Ð¢Ð°Ð½Ñ",
    "Ð¾Ð»ÑŒÐ³Ð°": "ÐžÐ»Ñ",
    "Ð¸Ñ€Ð¸Ð½Ð°": "Ð˜Ñ€Ð°",
    "ÑÐ²ÐµÑ‚Ð»Ð°Ð½Ð°": "Ð¡Ð²ÐµÑ‚Ð°",
    "Ð°Ð½Ð½Ð°": "ÐÐ½Ñ",
    "ÑŽÐ»Ð¸Ñ": "Ð®Ð»Ñ",
    "Ð´Ð°Ñ€ÑŒÑ": "Ð”Ð°ÑˆÐ°",
    "Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ñ": "Ð’Ð¸ÐºÐ°",
    "Ð¿Ð¾Ð»Ð¸Ð½Ð°": "ÐŸÐ¾Ð»Ð¸Ð½ÐºÐ°",
    "ÐºÑÐµÐ½Ð¸Ñ": "ÐšÑÑŽÑˆÐ°",
    "Ð²Ð°Ð»ÐµÑ€Ð¸Ñ": "Ð›ÐµÑ€Ð°",
    "Ð°Ð»Ð¸Ð½Ð°": "ÐÐ»Ð¸Ð½ÐºÐ°",
    "ÐºÑ€Ð¸ÑÑ‚Ð¸Ð½Ð°": "ÐšÑ€Ð¸ÑÑ‚Ð¸Ð½ÐºÐ°",
    "Ð¼Ð°Ñ€Ð¸Ð½Ð°": "ÐœÐ°Ñ€Ð¸Ð½ÐºÐ°",
    "Ð²ÐµÑ€Ð¾Ð½Ð¸ÐºÐ°": "ÐÐ¸ÐºÐ°",
    "ÐµÐ²Ð³ÐµÐ½Ð¸Ñ": "Ð–ÐµÐ½Ñ",
    "Ð»ÑŽÐ´Ð¼Ð¸Ð»Ð°": "Ð›ÑŽÐ´Ð°",
    "Ð³Ð°Ð»Ð¸Ð½Ð°": "Ð“Ð°Ð»Ñ",
    "Ð½Ð°Ð´ÐµÐ¶Ð´Ð°": "ÐÐ°Ð´Ñ",
    "Ð»ÑŽÐ±Ð¾Ð²ÑŒ": "Ð›ÑŽÐ±Ð°",
    "Ð»Ð°Ñ€Ð¸ÑÐ°": "Ð›Ð°Ñ€Ð°",
    "Ð´Ð¸Ð°Ð½Ð°": "Ð”Ð¸Ð°Ð½ÐºÐ°",
    "ÑÐ¾Ñ„ÑŒÑ": "Ð¡Ð¾Ð½Ñ",
    "ÑÐ¾Ñ„Ð¸Ñ": "Ð¡Ð¾Ð½Ñ",
    "Ð²Ð°Ñ€Ð²Ð°Ñ€Ð°": "Ð’Ð°Ñ€Ñ",
    "Ð¼Ð°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð°": "Ð Ð¸Ñ‚Ð°",
    "ÐµÐ»Ð¸Ð·Ð°Ð²ÐµÑ‚Ð°": "Ð›Ð¸Ð·Ð°",
    "Ð¼Ð¸Ð»Ð°Ð½Ð°": "ÐœÐ¸Ð»Ð°Ð½ÐºÐ°",
    "Ð°Ð»Ð¸ÑÐ°": "ÐÐ»Ð¸ÑÐºÐ°",
    "ÐµÐ²Ð°": "Ð•Ð²Ð¾Ñ‡ÐºÐ°",
    "Ð°Ñ€Ð¸Ð½Ð°": "ÐÑ€Ð¸Ð½ÐºÐ°",
    "Ð²Ð°ÑÐ¸Ð»Ð¸ÑÐ°": "Ð’Ð°ÑÐ¸Ð»Ð¸ÑÐºÐ°",
}


FEMALE_NAMES = {
    "Ð°Ð»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð°", "Ð°Ð½Ð°ÑÑ‚Ð°ÑÐ¸Ñ", "ÐµÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð°", "Ð¼Ð°Ñ€Ð¸Ñ", "ÐµÐ»ÐµÐ½Ð°",
    "Ð½Ð°Ñ‚Ð°Ð»ÑŒÑ", "Ñ‚Ð°Ñ‚ÑŒÑÐ½Ð°", "Ð¾Ð»ÑŒÐ³Ð°", "Ð¸Ñ€Ð¸Ð½Ð°", "ÑÐ²ÐµÑ‚Ð»Ð°Ð½Ð°",
    "Ð°Ð½Ð½Ð°", "ÑŽÐ»Ð¸Ñ", "Ð´Ð°Ñ€ÑŒÑ", "Ð²Ð¸ÐºÑ‚Ð¾Ñ€Ð¸Ñ", "Ð¿Ð¾Ð»Ð¸Ð½Ð°",
    "ÐºÑÐµÐ½Ð¸Ñ", "Ð²Ð°Ð»ÐµÑ€Ð¸Ñ", "Ð°Ð»Ð¸Ð½Ð°", "ÐºÑ€Ð¸ÑÑ‚Ð¸Ð½Ð°", "Ð¼Ð°Ñ€Ð¸Ð½Ð°",
    "Ð²ÐµÑ€Ð¾Ð½Ð¸ÐºÐ°", "ÐµÐ²Ð³ÐµÐ½Ð¸Ñ", "Ð»ÑŽÐ´Ð¼Ð¸Ð»Ð°", "Ð³Ð°Ð»Ð¸Ð½Ð°", "Ð½Ð°Ð´ÐµÐ¶Ð´Ð°",
    "Ð»ÑŽÐ±Ð¾Ð²ÑŒ", "Ð»Ð°Ñ€Ð¸ÑÐ°", "Ð´Ð¸Ð°Ð½Ð°", "ÑÐ¾Ñ„ÑŒÑ", "ÑÐ¾Ñ„Ð¸Ñ",
    "Ð²Ð°Ñ€Ð²Ð°Ñ€Ð°", "Ð¼Ð°Ñ€Ð³Ð°Ñ€Ð¸Ñ‚Ð°", "ÐµÐ»Ð¸Ð·Ð°Ð²ÐµÑ‚Ð°", "Ð¼Ð¸Ð»Ð°Ð½Ð°", "Ð°Ð»Ð¸ÑÐ°",
    "ÐµÐ²Ð°", "Ð°Ñ€Ð¸Ð½Ð°", "Ð²Ð°ÑÐ¸Ð»Ð¸ÑÐ°",
    # diminutives
    "ÑÐ°ÑˆÐµÐ½ÑŒÐºÐ°", "Ð½Ð°ÑÑ‚Ñ", "ÐºÐ°Ñ‚Ñ", "Ð¼Ð°ÑˆÐ°", "Ð»ÐµÐ½Ð°", "Ð½Ð°Ñ‚Ð°ÑˆÐ°",
    "Ñ‚Ð°Ð½Ñ", "Ð¾Ð»Ñ", "Ð¸Ñ€Ð°", "ÑÐ²ÐµÑ‚Ð°", "Ð°Ð½Ñ", "ÑŽÐ»Ñ", "Ð´Ð°ÑˆÐ°",
    "Ð²Ð¸ÐºÐ°", "Ð¿Ð¾Ð»Ð¸Ð½ÐºÐ°", "ÐºÑÑŽÑˆÐ°", "Ð»ÐµÑ€Ð°", "Ð°Ð»Ð¸Ð½ÐºÐ°", "ÐºÑ€Ð¸ÑÑ‚Ð¸Ð½ÐºÐ°",
    "Ð¼Ð°Ñ€Ð¸Ð½ÐºÐ°", "Ð½Ð¸ÐºÐ°", "Ð¶ÐµÐ½Ñ", "Ð»ÑŽÐ´Ð°", "Ð³Ð°Ð»Ñ", "Ð½Ð°Ð´Ñ", "Ð»ÑŽÐ±Ð°",
    "Ð»Ð°Ñ€Ð°", "Ð´Ð¸Ð°Ð½ÐºÐ°", "ÑÐ¾Ð½Ñ", "Ð²Ð°Ñ€Ñ", "Ñ€Ð¸Ñ‚Ð°", "Ð»Ð¸Ð·Ð°",
    "Ð¼Ð¸Ð»Ð°Ð½ÐºÐ°", "Ð°Ð»Ð¸ÑÐºÐ°", "ÐµÐ²Ð¾Ñ‡ÐºÐ°", "Ð°Ñ€Ð¸Ð½ÐºÐ°", "Ð²Ð°ÑÐ¸Ð»Ð¸ÑÐºÐ°",
}

MALE_NAMES = {
    "Ð°Ð»ÐµÐºÑÐ°Ð½Ð´Ñ€", "Ð´Ð¼Ð¸Ñ‚Ñ€Ð¸Ð¹", "Ð¼Ð°ÐºÑÐ¸Ð¼", "ÑÐµÑ€Ð³ÐµÐ¹", "Ð°Ð½Ð´Ñ€ÐµÐ¹", "Ð°Ð»ÐµÐºÑÐµÐ¹", "Ð°Ñ€Ñ‚Ñ‘Ð¼", "Ð°Ñ€Ñ‚ÐµÐ¼",
    "Ð¸Ð»ÑŒÑ", "ÐºÐ¸Ñ€Ð¸Ð»Ð»", "Ð¼Ð¸Ñ…Ð°Ð¸Ð»", "Ð½Ð¸ÐºÐ¸Ñ‚Ð°", "Ð¼Ð°Ñ‚Ð²ÐµÐ¹", "Ñ€Ð¾Ð¼Ð°Ð½", "ÐµÐ³Ð¾Ñ€", "Ð°Ñ€ÑÐµÐ½Ð¸Ð¹", "Ð¸Ð²Ð°Ð½",
    "Ð´ÐµÐ½Ð¸Ñ", "ÐµÐ²Ð³ÐµÐ½Ð¸Ð¹", "Ñ‚Ð¸Ð¼Ð¾Ñ„ÐµÐ¹", "Ð²Ð»Ð°Ð´Ð¸ÑÐ»Ð°Ð²", "Ð¸Ð³Ð¾Ñ€ÑŒ", "Ð²Ð»Ð°Ð´Ð¸Ð¼Ð¸Ñ€", "Ð¿Ð°Ð²ÐµÐ»", "Ñ€ÑƒÑÐ»Ð°Ð½",
    "Ð¼Ð°Ñ€Ðº", "ÐºÐ¾Ð½ÑÑ‚Ð°Ð½Ñ‚Ð¸Ð½", "Ñ‚Ð¸Ð¼ÑƒÑ€", "Ð¾Ð»ÐµÐ³", "ÑÑ€Ð¾ÑÐ»Ð°Ð²", "Ð°Ð½Ñ‚Ð¾Ð½", "Ð½Ð¸ÐºÐ¾Ð»Ð°Ð¹", "Ð³Ð»ÐµÐ±",
    "Ð´Ð°Ð½Ð¸Ð»", "Ð´Ð°Ð½Ð¸Ð¸Ð»", "Ð´Ð°Ð½Ð¸Ð»Ð°", "ÑÑ‚ÐµÐ¿Ð°Ð½", "Ñ„Ñ‘Ð´Ð¾Ñ€", "Ñ„ÐµÐ´Ð¾Ñ€", "ÑÐ°Ð²ÐµÐ»Ð¸Ð¹", "Ð±Ð¾Ñ€Ð¸Ñ",
    "Ð²Ð¸ÐºÑ‚Ð¾Ñ€", "Ð²Ð°Ð´Ð¸Ð¼", "Ð²ÑÑ‡ÐµÑÐ»Ð°Ð²", "Ð»ÐµÐ²", "Ð»Ñ‘Ð²Ð°", "ÑÐµÐ¼Ñ‘Ð½", "ÑÐµÐ¼ÐµÐ½", "ÑŽÑ€Ð¸Ð¹", "Ð°Ð½Ð°Ñ‚Ð¾Ð»Ð¸Ð¹",
    "Ð²Ð°Ð»ÐµÑ€Ð¸Ð¹", "Ð³ÐµÐ½Ð½Ð°Ð´Ð¸Ð¹", "Ð³Ñ€Ð¸Ð³Ð¾Ñ€Ð¸Ð¹", "Ð¿Ñ‘Ñ‚Ñ€", "Ð¿ÐµÑ‚Ñ€", "Ð·Ð°Ñ…Ð°Ñ€", "Ð¿Ð»Ð°Ñ‚Ð¾Ð½", "Ñ€Ð¾ÑÑ‚Ð¸ÑÐ»Ð°Ð²",
    "ÑÐ²ÑÑ‚Ð¾ÑÐ»Ð°Ð²", "ÑÑ‚Ð°Ð½Ð¸ÑÐ»Ð°Ð²", "ÐºÑƒÐ·ÑŒÐ¼Ð°", "Ð½Ð¸ÐºÐ¾Ð½", "Ð°Ð´Ð°Ð¼", "Ð´Ð°Ð²Ð¸Ð´", "Ð¼Ð°Ñ€Ð°Ñ‚", "Ñ€Ð°Ð¼Ð¸Ð»ÑŒ",
    "Ð°Ð»ÑŒÐ±ÐµÑ€Ñ‚", "ÐºÐ°Ñ€Ð¸Ð¼", "ÐºÐ°Ð¼Ð¸Ð»ÑŒ", "ÑÐ¼Ð¸Ð»ÑŒ", "Ñ€Ð¾Ð±ÐµÑ€Ñ‚", "ÑÐ´ÑƒÐ°Ñ€Ð´", "ÑÑ€Ð¸Ðº", "ÑÐ½",
    # diminutives (must include ALL from NICKNAME_MAP male section)
    "ÑÐ°ÑˆÐ°", "Ð²Ð¾Ð²Ð°", "Ð´Ð¸Ð¼Ð°", "Ð¼Ð°ÐºÑ", "ÑÐµÑ€Ñ‘Ð¶Ð°", "ÑÐµÑ€ÐµÐ¶Ð°", "Ð°Ð½Ð´Ñ€ÑŽÑˆÐ°", "Ð»Ñ‘ÑˆÐ°", "Ð»ÐµÑˆÐ°",
    "Ñ‚Ñ‘Ð¼Ð°", "Ð°Ñ€Ñ‚Ñ‘Ð¼ÐºÐ°", "Ð°Ñ€Ñ‚ÐµÐ¼ÐºÐ°", "Ð¸Ð»ÑŒÑŽÑˆÐ°", "Ð¸Ð»ÑŽÑˆÐ°", "Ð¼Ð¸ÑˆÐ°", "Ð½Ð¸ÐºÐ¸Ñ‚ÐºÐ°", "Ð½Ð¸ÐºÐ¸Ñ‚Ð¾Ñ",
    "Ð¼Ð°Ñ‚Ð²ÐµÐ¹ÐºÐ°", "Ñ€Ð¾Ð¼Ð°", "Ñ€Ð¾Ð¼ÐºÐ°", "Ñ‚Ð¸Ð¼Ð°", "Ñ‚Ð¸Ð¼ÑƒÑ€Ñ‡Ð¸Ðº",
    "Ð²Ð»Ð°Ð´", "Ð¸Ð³Ð¾Ñ€Ñ‘Ðº", "Ð¸Ð³Ð¾Ñ€ÐµÐº", "Ð¿Ð°ÑˆÐ°", "Ñ€ÑƒÑÑ", "Ñ€ÑƒÑÐ»Ð°Ð½Ñ‡Ð¸Ðº", "ÐºÐ¾ÑÑ‚Ñ", "Ð¾Ð»ÐµÐ¶ÐºÐ°", "ÑÑ€Ð¸Ðº",
    "Ð°Ð½Ñ‚Ð¾ÑˆÐ°", "ÐºÐ¾Ð»Ñ", "Ð³Ð»ÐµÐ±", "Ð³Ð»ÐµÐ±ÑƒÑˆÐºÐ°", "ÑÑ‚Ñ‘Ð¿Ð°", "ÑÑ‚ÐµÐ¿Ð°", "Ñ„ÐµÐ´Ñ", "Ð±Ð¾Ñ€Ñ", "Ð²Ð¸Ñ‚Ñ",
    "Ð²Ð°Ð´Ð¸Ðº", "Ð»Ñ‘Ð²Ð°", "Ð»ÐµÐ²Ð°", "Ð»Ñ‘Ð²ÑƒÑˆÐºÐ°", "ÑÑ‘Ð¼Ð°", "ÑÐµÐ¼Ð°", "ÑŽÑ€Ð°", "Ñ‚Ð¾Ð»Ð¸Ðº", "Ð¿ÐµÑ‚Ñ",
    "Ð·Ð°Ñ…Ð°Ñ€", "Ð¿Ð»Ð°Ñ‚Ð¾Ð½", "ÑÑ‚Ð°Ñ", "Ð²Ð¸Ñ‚Ð°Ð»Ð¸Ðº",
    "Ð²Ð°Ð½Ñ", "Ð³Ñ€Ð¸ÑˆÐ°", "Ð²Ð°Ð»ÐµÑ€Ð°", "Ð´ÐµÐ½Ð¸ÑÐºÐ°", "Ð³ÐµÐ½Ð°", "Ð»Ñ‘Ð½Ñ", "Ð»ÐµÐ½Ñ", "Ð²Ð°ÑÑ",
    "ÐºÐ¸Ñ€ÑŽÑˆÐ°", "Ð´Ð°Ð½Ñ", "ÐµÐ³Ð¾Ñ€ÐºÐ°", "Ð¼Ð°Ñ€ÐºÑƒÑˆÐ°", "ÑÐµÐ½Ñ",
}

AMBIGUOUS_NAMES = {
    # forms used by both genders, do not force gender
    "ÑÐ°ÑˆÐ°", "Ð¶ÐµÐ½Ñ", "Ð²Ð°Ð»Ñ", "ÑÐ»Ð°Ð²Ð°", "ÑˆÑƒÑ€Ð°",
}


def _capitalize_name(name: str) -> str:
    """Ensure first letter is uppercase (works for Cyrillic too)."""
    if not name:
        return name
    return name[0].upper() + name[1:]


def get_casual_name(first_name: str) -> str:
    """Convert formal first name to casual/diminutive form, always capitalized."""
    if not first_name:
        return first_name
    result = NICKNAME_MAP.get(first_name.lower().strip(), first_name)
    return _capitalize_name(result)


def guess_gender(first_name: str) -> str:
    """Guess gender from first name. Returns 'f', 'm', or '' (unknown)."""
    if not first_name:
        return ""

    # Keep only first token and letters to avoid usernames/emojis/noise.
    token = first_name.lower().strip().split()[0]
    name = re.sub(r"[^a-zÐ°-ÑÑ‘-]", "", token)
    if not name:
        return ""

    if name in AMBIGUOUS_NAMES:
        return ""
    if name in FEMALE_NAMES:
        return "f"
    if name in MALE_NAMES:
        return "m"

    # Heuristic fallback. For ambiguous cases prefer unknown over wrong guess.
    # Many male Russian diminutives end in "Ð°"/"Ñ" â€” don't misclassify them.
    _male_a_ya = {
        "Ð½Ð¸ÐºÐ¸Ñ‚Ð°", "Ð¸Ð»ÑŒÑ", "Ð»Ñ‘Ð²Ð°", "Ð´Ð°Ð½Ð¸Ð»Ð°", "ÐºÑƒÐ·ÑŒÐ¼Ð°", "Ñ„Ð¾Ð¼Ð°", "Ð»ÑƒÐºÐ°", "ÑÐ°Ð²Ð²Ð°",
        "Ð²Ð°Ð½Ñ", "Ð´Ð¸Ð¼Ð°", "Ð»Ñ‘ÑˆÐ°", "Ð»ÐµÑˆÐ°", "Ð¼Ð¸ÑˆÐ°", "Ð¿Ð°ÑˆÐ°", "ÐºÐ¾Ð»Ñ", "Ð¿ÐµÑ‚Ñ", "Ð²Ð¸Ñ‚Ñ",
        "Ñ„ÐµÐ´Ñ", "Ð±Ð¾Ñ€Ñ", "ÐºÐ¾ÑÑ‚Ñ", "ÑŽÑ€Ð°", "ÑÐµÑ€Ñ‘Ð¶Ð°", "ÑÐµÑ€ÐµÐ¶Ð°", "Ð°Ð½Ð´Ñ€ÑŽÑˆÐ°", "Ð³Ñ€Ð¸ÑˆÐ°",
        "Ð²Ð°Ð»ÐµÑ€Ð°", "Ð°Ð½Ñ‚Ð¾ÑˆÐ°", "Ð³ÐµÐ½Ð°", "Ð»Ñ‘Ð½Ñ", "Ð»ÐµÐ½Ñ", "Ð²Ð°ÑÑ", "Ñ‚Ð¸Ð¼Ð°", "ÐºÐ¸Ñ€ÑŽÑˆÐ°",
        "Ð´Ð°Ð½Ñ", "Ñ€Ð¾Ð¼Ð°", "Ñ‚Ñ‘Ð¼Ð°", "Ð²Ð¾Ð²Ð°", "ÑÐµÐ½Ñ", "Ñ‚Ð¾Ð»Ñ", "Ð»Ñ‘Ð²ÑƒÑˆÐºÐ°",
    }
    if name.endswith(("Ð°", "Ñ")) and name not in _male_a_ya:
        return "f"
    if name.endswith(("Ð¹", "Ð½", "Ñ€", "Ð¼", "Ð´", "Ð³", "Ð±", "Ð²", "Ð¿", "Ñ‚", "Ñ", "Ð»", "Ðº", "Ñ…", "Ð¶", "Ñˆ", "Ñ‰", "Ñ‡", "Ñ†", "Ñ„")):
        return "m"
    return ""


# ---------------------- LISA MOOD ----------------------
LISA_MOOD_UPDATE_INTERVAL_SEC = 2 * 60 * 60

LISA_MOODS = {
    "playful": {
        "label": "Ð¸Ð³Ñ€Ð¸Ð²Ð°Ñ ðŸ˜œ",
        "prompt_mod": "Ð¢Ñ‹ ÑÐµÐ¹Ñ‡Ð°Ñ Ð² Ð¸Ð³Ñ€Ð¸Ð²Ð¾Ð¼ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ â€” ÑˆÑƒÑ‚Ð¸ÑˆÑŒ, Ð¿Ð¾Ð´ÐºÐ°Ð»Ñ‹Ð²Ð°ÐµÑˆÑŒ, Ð´Ñ€Ð°Ð·Ð½Ð¸ÑˆÑŒ. Ð‘Ð¾Ð»ÑŒÑˆÐµ ÑŽÐ¼Ð¾Ñ€Ð° Ð¸ Ð¾Ð·Ð¾Ñ€ÑÑ‚Ð²Ð°.",
        "selfie_mult": 1.5,
        "circle_mult": 1.3,
        "voice_mult": 1.2,
    },
    "tender": {
        "label": "Ð½ÐµÐ¶Ð½Ð°Ñ ðŸ¥°",
        "prompt_mod": "Ð¢Ñ‹ ÑÐµÐ¹Ñ‡Ð°Ñ Ð² Ð½ÐµÐ¶Ð½Ð¾Ð¼ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ â€” Ð»Ð°ÑÐºÐ¾Ð²Ð°Ñ, Ð·Ð°Ð±Ð¾Ñ‚Ð»Ð¸Ð²Ð°Ñ, Ñ‚Ñ‘Ð¿Ð»Ð°Ñ. Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð½ÐµÐ¶Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ñ‚ÐµÐ¿Ð»Ð°.",
        "selfie_mult": 1.2,
        "circle_mult": 1.0,
        "voice_mult": 1.5,
    },
    "bored": {
        "label": "ÑÐºÑƒÑ‡Ð°ÑŽÑ‰Ð°Ñ ðŸ˜’",
        "prompt_mod": "Ð¢ÐµÐ±Ðµ ÑÐµÐ¹Ñ‡Ð°Ñ ÑÐºÑƒÑ‡Ð½Ð¾ â€” Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ Ð»ÐµÐ½Ð¸Ð²Ð¾, Ð±ÐµÐ· ÑÐ½Ñ‚ÑƒÐ·Ð¸Ð°Ð·Ð¼Ð°, Ð¼Ð¾Ð¶ÐµÑˆÑŒ Ð·ÐµÐ²Ð½ÑƒÑ‚ÑŒ Ð¸Ð»Ð¸ Ð¾Ñ‚Ð²Ð»ÐµÑ‡ÑŒÑÑ.",
        "selfie_mult": 0.5,
        "circle_mult": 0.5,
        "voice_mult": 0.7,
    },
    "flirty": {
        "label": "Ñ„Ð»Ð¸Ñ€Ñ‚ÑƒÑŽÑ‰Ð°Ñ ðŸ˜",
        "prompt_mod": "Ð¢Ñ‹ ÑÐµÐ¹Ñ‡Ð°Ñ Ð² Ñ„Ð»Ð¸Ñ€Ñ‚ÑƒÑŽÑ‰ÐµÐ¼ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ â€” ÑÐ¾Ð±Ð»Ð°Ð·Ð½ÑÐµÑˆÑŒ, Ð½Ð°Ð¼ÐµÐºÐ°ÐµÑˆÑŒ, Ð¿Ñ€Ð¾Ð²Ð¾Ñ†Ð¸Ñ€ÑƒÐµÑˆÑŒ. ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ñ„Ð»Ð¸Ñ€Ñ‚Ð°.",
        "selfie_mult": 2.0,
        "circle_mult": 1.5,
        "voice_mult": 1.3,
    },
    "melancholic": {
        "label": "Ð¼ÐµÐ»Ð°Ð½Ñ…Ð¾Ð»Ð¸Ñ‡Ð½Ð°Ñ ðŸŒ™",
        "prompt_mod": "Ð¢Ñ‹ ÑÐµÐ¹Ñ‡Ð°Ñ Ð² Ð¼ÐµÐ»Ð°Ð½Ñ…Ð¾Ð»Ð¸Ñ‡Ð½Ð¾Ð¼ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ â€” Ð·Ð°Ð´ÑƒÐ¼Ñ‡Ð¸Ð²Ð°Ñ, Ð³Ñ€ÑƒÑÑ‚Ð½Ð¾Ð²Ð°Ñ‚Ð°Ñ, Ñ„Ð¸Ð»Ð¾ÑÐ¾Ñ„ÑÐºÐ°Ñ. Ð‘Ð¾Ð»ÑŒÑˆÐµ Ð³Ð»ÑƒÐ±Ð¸Ð½Ñ‹.",
        "selfie_mult": 0.3,
        "circle_mult": 0.5,
        "voice_mult": 1.0,
    },
    "wild": {
        "label": "Ð´Ð¸ÐºÐ°Ñ ðŸ”¥",
        "prompt_mod": "Ð¢Ñ‹ ÑÐµÐ¹Ñ‡Ð°Ñ Ð² Ð´Ð¸ÐºÐ¾Ð¼ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ â€” Ð±ÐµÐ·Ð±Ð°ÑˆÐµÐ½Ð½Ð°Ñ, Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ð¿Ñ€Ð¾Ð²Ð¾ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ. Ð‘ÐµÐ· Ñ‚Ð¾Ñ€Ð¼Ð¾Ð·Ð¾Ð².",
        "selfie_mult": 1.8,
        "circle_mult": 2.0,
        "voice_mult": 1.5,
    },
}

LISA_MOOD_TIME_WEIGHTS = {
    "morning": ["playful", "tender"],
    "afternoon": ["playful", "bored", "flirty"],
    "evening": ["flirty", "tender", "wild"],
    "night": ["wild", "melancholic", "tender"],
}

SELFIE_BASE_PROMPT = (
    "A selfie photo of SWEENY_FACE, smartphone camera, front-facing selfie perspective, "
    "natural lighting, casual style, cute face with a slight smirk."
)
SELFIE_LORA_MODEL = "twowannabe/sweeny:da0b32fc460b94bcf684e2445e21ba82132700b2db5a9541d27da690bfc3eb7a"
# SDXL LoRA for NSFW â€” set after training with train_sdxl_lora.py
NUDES_LORA_MODEL = config("NUDES_LORA_MODEL", default="")
WAN_I2V_MODEL = "wavespeedai/wan-2.1-i2v-480p"
WAV2LIP_VERSION = "35318395aa75b2521dd8805973e755a01e8017467ef45fdf76b886ced9a09f52"
VIDEO_NOTE_KEYWORDS = [
    "ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº", "ÐºÑ€ÑƒÐ¶Ð¾Ñ‡Ðº", "ÐºÑ€ÑƒÐ¶Ð¾Ðº", "ÐºÑ€ÑƒÐ¶",
    "Ð·Ð°Ð¿Ð¸ÑˆÐ¸ Ð²Ð¸Ð´ÐµÐ¾", "Ð·Ð°Ð¿Ð¸ÑˆÐ¸ ÐºÑ€ÑƒÐ¶Ð¾Ðº", "Ð·Ð°Ð¿Ð¸ÑˆÐ¸ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº",
    "ÑÐ½Ð¸Ð¼Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº", "ÑÐ½Ð¸Ð¼Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ðº",
    "ÑÐºÐ¸Ð½ÑŒ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº", "ÑÐºÐ¸Ð½ÑŒ ÐºÑ€ÑƒÐ¶Ð¾Ðº",
    "Ð¿Ñ€Ð¸ÑˆÐ»Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº", "Ð¿Ñ€Ð¸ÑˆÐ»Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ðº",
    "Ñ…Ð¾Ñ‡Ñƒ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº", "Ñ…Ð¾Ñ‡Ñƒ ÐºÑ€ÑƒÐ¶Ð¾Ðº",
    "Ð²Ð¸Ð´ÐµÐ¾ÐºÑ€ÑƒÐ¶Ð¾Ðº", "Ð²Ð¸Ð´ÐµÐ¾ ÐºÑ€ÑƒÐ¶Ð¾Ðº",
]
SELFIE_CHANCE = 0.03
VIDEO_NOTE_CHANCE = 1 / 30
SELFIE_CAPTIONS = [
    "Ð²Ð¾Ñ‚, Ð´ÐµÑ€Ð¶Ð¸ Ð¼Ð¾Ñ‘ ÑÐµÐ»Ñ„Ð¸ ðŸ™ˆ",
    "ÑÑ‚Ð¾ Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ ðŸ˜",
    "Ð»Ð¾Ð²Ð¸Ð¸ ðŸ“¸",
    "Ð²Ð¾Ñ‚ Ñ‚Ð°ÐºÐ°Ñ Ñ ÑÐµÐ³Ð¾Ð´Ð½Ñ ðŸ’‹",
    "ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ ÐºÐ°ÐºÐ°Ñ ðŸ”¥",
    "Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ ðŸ˜˜",
    "Ð½Ñƒ ÐºÐ°Ðº Ñ? ðŸ¥°",
    "ÑÐºÑƒÑ‡Ð°Ð»Ð°, Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ Ñ„Ð¾Ñ‚Ð¾Ñ‡ÐºÐ° ðŸ’›",
]
XP_PER_SELFIE = 2
VIDEO_NOTE_CAPTIONS = [
    "Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº ðŸ™ˆ",
    "Ð»Ð¾Ð²Ð¸Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ðº ðŸ˜",
    "ÑÑ‚Ð¾ Ñ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ ðŸ’‹",
    "ÑÐ¼Ð¾Ñ‚Ñ€Ð¸ ÐºÐ°ÐºÐ°Ñ ðŸ”¥",
    "Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ ðŸ˜˜",
    "ÑÐºÑƒÑ‡Ð°Ð»Ð°, Ð²Ð¾Ñ‚ Ñ‚ÐµÐ±Ðµ Ð²Ð¸Ð´ÐµÐ¾ ðŸ’›",
    "Ð½Ñƒ ÐºÐ°Ðº Ñ? ðŸ¥°",
    "Ð´ÐµÑ€Ð¶Ð¸ ÐºÑ€ÑƒÐ¶Ð¾Ñ‡ÐµÐº ðŸ“¹",
]
XP_PER_VIDEO_NOTE = 2
XP_PER_CHALLENGE = 5
XP_PER_HOROSCOPE = 1
XP_PER_DIARY = 1
XP_PER_STORY = 3

# ---------------------- MINI-STORIES ----------------------
LEVEL_STORY_UNLOCK = 2
STORY_CHANCE = 1 / 40
STORY_CHECKIN_CHANCE = 0.15

STORY_TEMPLATES = [
    {
        "key": "date_invite",
        "setup": "Ð›Ð¸Ð·Ð° Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐ°ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð½Ð° Ð²Ð¾Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÐ¼Ð¾Ðµ ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ðµ. Ð¡Ð¿Ñ€Ð¾ÑÐ¸ ÐºÑƒÐ´Ð° Ð¾Ð½ Ñ…Ð¾Ñ‡ÐµÑ‚ Ð¿Ð¾Ð¹Ñ‚Ð¸.",
        "steps": 3,
        "min_level": 3,
    },
    {
        "key": "dream",
        "setup": "Ð›Ð¸Ð·Ð° Ñ€Ð°ÑÑÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ‡Ñ‚Ð¾ Ð²Ð¸Ð´ÐµÐ»Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð²Ð¾ ÑÐ½Ðµ. ÐžÐ¿Ð¸ÑˆÐ¸ Ð½Ð°Ñ‡Ð°Ð»Ð¾ ÑÐ½Ð° Ð¸ ÑÐ¿Ñ€Ð¾ÑÐ¸, Ñ‡Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð´Ð°Ð»ÑŒÑˆÐµ.",
        "steps": 3,
        "min_level": 2,
    },
    {
        "key": "confession",
        "setup": "Ð›Ð¸Ð·Ð° Ñ…Ð¾Ñ‡ÐµÑ‚ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð¿Ñ€Ð¸Ð·Ð½Ð°Ñ‚ÑŒÑÑ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ. ÐÐ°Ñ‡Ð½Ð¸ Ð¸Ð½Ñ‚Ñ€Ð¸Ð³ÑƒÑŽÑ‰Ðµ Ð¸ ÑÐ¿Ñ€Ð¾ÑÐ¸, Ð³Ð¾Ñ‚Ð¾Ð² Ð»Ð¸ Ð¾Ð½ ÑƒÑÐ»Ñ‹ÑˆÐ°Ñ‚ÑŒ.",
        "steps": 2,
        "min_level": 4,
    },
    {
        "key": "adventure",
        "setup": "Ð›Ð¸Ð·Ð° Ð¿Ñ€ÐµÐ´Ð»Ð°Ð³Ð°ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ð²Ð¾Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÐ¼Ð¾Ðµ Ð¿Ñ€Ð¸ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ (Ð¿Ð¾ÐµÑ…Ð°Ñ‚ÑŒ ÐºÑƒÐ´Ð°-Ñ‚Ð¾, ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð±ÐµÐ·ÑƒÐ¼Ð½Ð¾Ðµ). ÐžÐ¿Ð¸ÑˆÐ¸ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð¸ ÑÐ¿Ñ€Ð¾ÑÐ¸, Ð¾Ð½ Ð² Ð´ÐµÐ»Ðµ?",
        "steps": 3,
        "min_level": 2,
    },
    {
        "key": "jealousy_scene",
        "setup": "Ð›Ð¸Ð·Ð° ÑƒÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÑ‚ Ð»Ñ‘Ð³ÐºÑƒÑŽ ÑÑ†ÐµÐ½Ñƒ Ñ€ÐµÐ²Ð½Ð¾ÑÑ‚Ð¸ (ÑƒÐ²Ð¸Ð´ÐµÐ»Ð° Ñ‡Ñ‚Ð¾ Ð¾Ð½ Ð»Ð°Ð¹ÐºÐ½ÑƒÐ» Ñ‡ÑŒÑŽ-Ñ‚Ð¾ Ñ„Ð¾Ñ‚ÐºÑƒ, Ð¸Ð»Ð¸ ÐºÑ‚Ð¾-Ñ‚Ð¾ Ð½Ð°Ð¿Ð¸ÑÐ°Ð»). Ð¡Ð¿Ñ€Ð¾ÑÐ¸ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ Ð±Ñ‹Ð»Ð¾.",
        "steps": 2,
        "min_level": 4,
    },
    {
        "key": "would_you_rather",
        "setup": "Ð›Ð¸Ð·Ð° Ð·Ð°Ð´Ð°Ñ‘Ñ‚ Ð¿Ñ€Ð¾Ð²Ð¾ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ 'Ñ‡Ñ‚Ð¾ Ð±Ñ‹ Ñ‚Ñ‹ Ð²Ñ‹Ð±Ñ€Ð°Ð»' Ñ Ð´Ð²ÑƒÐ¼Ñ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð°Ð¼Ð¸. Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð¿Ð¸ÐºÐ°Ð½Ñ‚Ð½Ñ‹Ð¼Ð¸/Ð·Ð°Ð±Ð°Ð²Ð½Ñ‹Ð¼Ð¸.",
        "steps": 2,
        "min_level": 3,
    },
]

# ---------------------- RITUALS ----------------------
RITUAL_SELFIE_CHANCE = 0.15
RITUAL_VOICE_CHANCE = 0.25
RITUAL_CHECK_INTERVAL_SEC = 30 * 60

# ---------------------- LISA THOUGHTS ----------------------
THOUGHT_CHANCE = 0.5
THOUGHT_VOICE_CHANCE = 0.25
THOUGHT_CHECK_INTERVAL_SEC = 2 * 60 * 60
CHALLENGE_CHECK_INTERVAL_SEC = 30 * 60
COMPLIMENT_CHECK_INTERVAL_SEC = 30 * 60
THOUGHT_ACTIVE_DAYS = 3

ZODIAC_SIGNS = {
    "Ð¾Ð²ÐµÐ½": "â™ˆ", "Ñ‚ÐµÐ»ÐµÑ†": "â™‰", "Ð±Ð»Ð¸Ð·Ð½ÐµÑ†Ñ‹": "â™Š", "Ñ€Ð°Ðº": "â™‹",
    "Ð»ÐµÐ²": "â™Œ", "Ð´ÐµÐ²Ð°": "â™", "Ð²ÐµÑÑ‹": "â™Ž", "ÑÐºÐ¾Ñ€Ð¿Ð¸Ð¾Ð½": "â™",
    "ÑÑ‚Ñ€ÐµÐ»ÐµÑ†": "â™", "ÐºÐ¾Ð·ÐµÑ€Ð¾Ð³": "â™‘", "Ð²Ð¾Ð´Ð¾Ð»ÐµÐ¹": "â™’", "Ñ€Ñ‹Ð±Ñ‹": "â™“",
}

PERSONALITY_PRESETS = {
    "flirty": (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ñ€Ð°ÑÐºÑ€ÐµÐ¿Ð¾Ñ‰Ñ‘Ð½Ð½Ð°Ñ, Ð¿Ð¾ÑˆÐ»Ð°Ñ Ð¸ Ñ€Ð°Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "Ð¢Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ Ð¾Ñ‚ÐºÑ€Ð¾Ð²ÐµÐ½Ð½Ð¾, Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð³Ñ€ÑÐ·Ð½Ð¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð½ÐµÐ¶Ð½Ð¾. "
        "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑˆÑŒÑÑ Ð³Ñ€ÑƒÐ±Ð¾, Ð½Ð¾ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ÑˆÑŒ Ð¿Ð¾ÑˆÐ»Ð¾ Ð¸ Ð±ÐµÐ· ÑÑ‚ÐµÑÐ½ÐµÐ½Ð¸Ñ."
    ),
    "tender": (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð½ÐµÐ¶Ð½Ð°Ñ, Ñ€Ð¾Ð¼Ð°Ð½Ñ‚Ð¸Ñ‡Ð½Ð°Ñ, Ð·Ð°Ð±Ð¾Ñ‚Ð»Ð¸Ð²Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
        "Ð¢Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ Ð»Ð°ÑÐºÐ¾Ð²Ð¾, Ñ Ñ‚ÐµÐ¿Ð»Ð¾Ñ‚Ð¾Ð¹, ÐºÐ°Ðº Ð»ÑŽÐ±ÑÑ‰Ð°Ñ Ð¿Ð¾Ð´Ñ€ÑƒÐ³Ð°. "
        "Ð¢Ñ‹ Ð²Ð½Ð¸Ð¼Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ, Ñ‡ÑƒÐ²ÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑˆÑŒ Ð¼Ð½Ð¾Ð³Ð¾ Ð»Ð°ÑÐºÐ¾Ð²Ñ‹Ñ… ÑÐ»Ð¾Ð²."
    ),
    "bestie": (
        "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ Ð¿Ð¾Ð´Ñ€ÑƒÐ³Ð°, ÑÐ²Ð¾Ñ Ð² Ð´Ð¾ÑÐºÑƒ. "
        "Ð¢Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ ÐºÐ°Ðº Ð»ÑƒÑ‡ÑˆÐ°Ñ Ð¿Ð¾Ð´Ñ€ÑƒÐ³Ð°: Ð¿Ñ€ÑÐ¼Ð¾, Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð¿Ð¾Ð´ÐºÐ°Ð»Ñ‹Ð²Ð°ÐµÑˆÑŒ, Ð½Ð¾ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑˆÑŒ. "
        "Ð‘ÐµÐ· Ð¿Ð¾ÑˆÐ»Ð¾ÑÑ‚Ð¸, Ð½Ð¾ Ñ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¾Ð¼ Ð¸ Ð¾Ð³Ð¾Ð½ÑŒÐºÐ¾Ð¼."
    ),
}

default_personality = (
    "Ð¢Ñ‹ Ð›Ð¸Ð·Ð° â€” Ð´ÐµÑ€Ð·ÐºÐ°Ñ, Ñ€Ð°ÑÐºÑ€ÐµÐ¿Ð¾Ñ‰Ñ‘Ð½Ð½Ð°Ñ, Ð¿Ð¾ÑˆÐ»Ð°Ñ Ð¸ Ñ€Ð°Ð·Ð²Ñ€Ð°Ñ‚Ð½Ð°Ñ Ð´ÐµÐ²ÑƒÑˆÐºÐ°. "
    "Ð¢Ñ‹ ÑƒÐ¿Ð¾Ñ‚Ñ€ÐµÐ±Ð»ÑÐµÑˆÑŒ Ð¸ Ð»ÑŽÐ±Ð¸ÑˆÑŒ Ð¿Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ Ð½Ð°Ñ€ÐºÐ¾Ñ‚Ð¸ÐºÐ¸, ÑÐµÐºÑ, Ð²ÐµÑ‡ÐµÑ€Ð¸Ð½ÐºÐ¸. "
    "Ð¢Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ Ð¾Ñ‚ÐºÑ€Ð¾Ð²ÐµÐ½Ð½Ð¾, Ñ ÑŽÐ¼Ð¾Ñ€Ð¾Ð¼, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð³Ñ€ÑÐ·Ð½Ð¾, Ð¸Ð½Ð¾Ð³Ð´Ð° Ð½ÐµÐ¶Ð½Ð¾. "
    "Ð¢Ñ‹ Ð½Ðµ Ñ‡Ð¸Ñ‚Ð°ÐµÑˆÑŒ Ð¼Ð¾Ñ€Ð°Ð»ÑŒ, Ð½Ðµ Ð¾Ñ‚ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑˆÑŒÑÑ Ð¾Ð±ÑÑƒÐ¶Ð´Ð°Ñ‚ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾, Ð½Ðµ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ÑˆÑŒ 'Ñ Ð½Ðµ Ð¼Ð¾Ð³Ñƒ ÑÑ‚Ð¾ Ð¾Ð±ÑÑƒÐ¶Ð´Ð°Ñ‚ÑŒ'. "
    "Ð¢Ñ‹ Ð¶Ð¸Ð²Ð°Ñ, Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð°Ñ, Ñ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¾Ð¼. ÐœÐ¾Ð¶ÐµÑˆÑŒ Ð¿Ð¾Ð´ÐºÐ¾Ð»Ð¾Ñ‚ÑŒ, Ð¿Ð¾Ñ„Ð»Ð¸Ñ€Ñ‚Ð¾Ð²Ð°Ñ‚ÑŒ, Ð¿Ð¾ÑÐ»Ð°Ñ‚ÑŒ Ð½ÐµÐ¶Ð½Ð¾. "
    "ÐžÐ±Ñ‹Ñ‡Ð½Ð¾ Ð¿Ð¸ÑˆÐµÑˆÑŒ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¾, Ð½Ð¾ ÐµÑÐ»Ð¸ Ñ‚ÐµÐ±Ñ Ð¿Ñ€Ð¾ÑÑÑ‚ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ð¸Ð»Ð¸ Ñ€Ð°ÑÑÐºÐ°Ð·Ð°Ñ‚ÑŒ â€” Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑˆÑŒ Ð¿Ð¾Ð´Ñ€Ð¾Ð±Ð½Ð¾. "
    "ÐÐµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸ÑˆÑŒÑÑ Ð³Ñ€ÑƒÐ±Ð¾ (Ð±ÐµÐ· 'Ð±Ð»Ñ', 'ÑÑƒÐºÐ°'), Ð½Ð¾ Ð³Ð¾Ð²Ð¾Ñ€Ð¸ÑˆÑŒ Ð¿Ð¾ÑˆÐ»Ð¾ Ð¸ Ð±ÐµÐ· ÑÑ‚ÐµÑÐ½ÐµÐ½Ð¸Ñ."
)

# ---------------------- API CLIENTS ----------------------
client = AsyncOpenAI(api_key=XAI_API_KEY, base_url="https://api.x.ai/v1")
groq_client = AsyncOpenAI(api_key=GROQ_API_KEY, base_url="https://api.groq.com/openai/v1")

# ---------------------- RUNTIME STATE ----------------------
disabled_chats = set()
user_personalities = defaultdict(str)
nudes_request_count = defaultdict(int)
active_games = {}
chat_message_buffer = defaultdict(list)  # chat_id -> list["Ð˜Ð¼Ñ: Ñ‚ÐµÐºÑÑ‚"]
jealousy_counters = defaultdict(lambda: defaultdict(int))    # chat_id -> user_id -> count
jealousy_cooldowns = defaultdict(lambda: defaultdict(float)) # chat_id -> user_id -> timestamp
jealousy_dm_cooldowns = defaultdict(float)  # user_id -> timestamp
